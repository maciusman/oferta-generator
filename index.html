<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Interaktywnych Ofert HTML</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50">
    <!-- Header -->
    <header class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl font-bold mb-4">
                <i class="fas fa-magic mr-4"></i>
                Generator Interaktywnych Ofert HTML
            </h1>
            <p class="text-xl text-blue-100 mb-6 max-w-2xl mx-auto">
                Przekształć swoją ofertę w piękną, interaktywną stronę HTML w 3 prostych krokach
            </p>
        </div>
    </header>

    <!-- Main Generator -->
    <section class="py-12">
        <div class="container mx-auto px-4 max-w-4xl">
            
            <!-- Instructions -->
            <div class="bg-blue-50 border-l-4 border-blue-400 p-6 mb-8 rounded-r-lg">
                <h3 class="text-lg font-semibold text-blue-800 mb-3">
                    <i class="fas fa-info-circle mr-2"></i>Jak to działa?
                </h3>
                <ol class="text-blue-700 space-y-2">
                    <li><strong>1.</strong> Skopiuj tekst swojej oferty z Google Docs (Ctrl+A, Ctrl+C)</li>
                    <li><strong>2.</strong> Wklej go w polu poniżej i podaj swój klucz API Gemini</li>
                    <li><strong>3.</strong> Kliknij "Generuj" i otrzymaj publiczny link do udostępnienia</li>
                </ol>
            </div>

            <!-- Generator Form -->
            <div class="bg-white p-8 rounded-xl shadow-lg">
                
                <!-- API Key Section -->
                <div class="mb-6">
                    <label class="block text-lg font-semibold text-slate-700 mb-2">
                        <i class="fas fa-key mr-2 text-blue-500"></i>Klucz API Gemini
                    </label>
                    <div class="flex gap-4">
                        <input type="password" id="apiKey" 
                               placeholder="Wklej swój klucz API Gemini..." 
                               class="flex-1 p-4 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none">
                        <a href="https://aistudio.google.com/app/apikey" target="_blank" 
                           class="bg-blue-500 text-white px-6 py-4 rounded-lg hover:bg-blue-600 transition-colors whitespace-nowrap">
                            <i class="fas fa-external-link-alt mr-2"></i>Pobierz klucz
                        </a>
                    </div>
                    <p class="text-sm text-slate-500 mt-2">
                        Klucz jest darmowy i potrzebny do AI. Będzie zapisany tylko w Twojej przeglądarce.
                    </p>
                </div>

                <!-- Model Selection -->
                <div class="mb-6">
                    <label class="block text-lg font-semibold text-slate-700 mb-2">
                        <i class="fas fa-robot mr-2 text-green-500"></i>Model AI
                    </label>
                    <select id="modelSelect" class="w-full p-4 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none bg-white">
                        <option value="gemini-2.5-flash-preview-04-17">Gemini 2.5 Flash (Szybki, zalecany)</option>
                        <option value="gemini-1.5-pro">Gemini 1.5 Pro (Dokładny)</option>
                        <option value="gemini-1.5-flash">Gemini 1.5 Flash (Szybki)</option>
                    </select>
                </div>

                <!-- Text Input -->
                <div class="mb-6">
                    <label class="block text-lg font-semibold text-slate-700 mb-2">
                        <i class="fas fa-file-text mr-2 text-purple-500"></i>Tekst oferty z Google Docs
                    </label>
                    <textarea id="offerText" 
                              placeholder="Wklej tutaj całą treść swojej oferty z Google Docs..."
                              rows="12"
                              class="w-full p-4 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none resize-vertical"></textarea>
                    <p class="text-sm text-slate-500 mt-2">
                        Skopiuj całą ofertę z Google Docs (Ctrl+A, Ctrl+C) i wklej tutaj (Ctrl+V)
                    </p>
                </div>

                <!-- Generate Button -->
                <div class="text-center">
                    <button id="generateBtn" 
                            class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-12 py-4 rounded-lg text-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-200 transform hover:scale-105 shadow-lg">
                        <i class="fas fa-magic mr-3"></i>
                        Generuj Interaktywną Ofertę
                    </button>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden text-center py-8">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <h3 class="text-xl font-semibold text-slate-700 mb-2">Generowanie oferty...</h3>
                    <p id="loadingText" class="text-slate-500">Wysyłanie do AI...</p>
                </div>

                <!-- Success State -->
                <div id="successState" class="hidden">
                    <div class="bg-green-50 border-l-4 border-green-400 p-6 rounded-r-lg">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-check-circle text-green-500 text-2xl mr-3"></i>
                            <h3 class="text-lg font-semibold text-green-800">Oferta gotowa!</h3>
                        </div>
                        <p class="text-green-700 mb-4">Link jest ważny przez 7 dni:</p>
                        <div class="bg-white p-4 rounded-lg border border-green-200 mb-4">
                            <a id="generatedLink" href="#" target="_blank" 
                               class="text-blue-600 hover:text-blue-800 font-medium break-all"></a>
                        </div>
                        <div class="flex gap-3">
                            <button id="copyLinkBtn" 
                                    class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                                <i class="fas fa-copy mr-2"></i>Kopiuj Link
                            </button>
                            <button id="openLinkBtn" 
                                    class="flex-1 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                <i class="fas fa-external-link-alt mr-2"></i>Otwórz Ofertę
                            </button>
                        </div>
                        <button id="generateNewBtn" 
                                class="w-full mt-4 bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors">
                            <i class="fas fa-plus mr-2"></i>Generuj Nową Ofertę
                        </button>
                    </div>
                </div>

                <!-- Error State -->
                <div id="errorState" class="hidden">
                    <div class="bg-red-50 border-l-4 border-red-400 p-6 rounded-r-lg">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-exclamation-triangle text-red-500 text-2xl mr-3"></i>
                            <h3 class="text-lg font-semibold text-red-800">Wystąpił błąd</h3>
                        </div>
                        <p id="errorMessage" class="text-red-700 mb-4"></p>
                        <button id="retryBtn" 
                                class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                            <i class="fas fa-redo mr-2"></i>Spróbuj ponownie
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How it works -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4 max-w-4xl">
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-12">Alternatywnie: Bookmarklet</h2>
            <p class="text-center text-slate-600 mb-8">
                Dla jeszcze większej wygody możesz zainstalować bookmarklet, który automatycznie pobierze treść z Google Docs:
            </p><!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Interaktywnych Ofert HTML</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            scroll-behavior: smooth; 
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .bookmarklet-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: inline-block;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .bookmarklet-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            text-decoration: none;
            color: white;
        }
        .step-card {
            transition: all 0.3s ease;
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-slate-50">
    <!-- Header -->
    <header class="gradient-bg text-white py-16">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-5xl font-bold mb-4">
                <i class="fas fa-magic mr-4"></i>
                Generator Interaktywnych Ofert HTML
            </h1>
            <p class="text-xl text-blue-100 mb-8 max-w-3xl mx-auto">
                Przekształć swoje oferty z Google Docs w piękne, interaktywne strony HTML jednym kliknięciem. 
                Udostępniaj je przez publiczne linki i imponuj klientom.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="#instalacja" class="bg-white text-purple-600 px-8 py-4 rounded-lg font-semibold hover:bg-purple-50 transition-all">
                    <i class="fas fa-download mr-2"></i>Zainstaluj Bookmarklet
                </a>
                <a href="#instrukcja" class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-purple-600 transition-all">
                    <i class="fas fa-play mr-2"></i>Zobacz Instrukcję
                </a>
            </div>
        </div>
    </header>

    <!-- Features -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-12">Dlaczego Generator Ofert?</h2>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-bolt text-2xl text-blue-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Jeden Klik</h3>
                    <p class="text-slate-600">Przekształć ofertę z Google Docs w interaktywną stronę HTML w sekundach.</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-share-alt text-2xl text-green-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Publiczne Linki</h3>
                    <p class="text-slate-600">Otrzymuj publiczne linki, które możesz wysłać klientom email lub wstawić na stronę.</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-mobile-alt text-2xl text-purple-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Responsywne</h3>
                    <p class="text-slate-600">Oferty wyglądają świetnie na wszystkich urządzeniach - desktop, tablet, telefon.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Installation -->
    <section id="instalacja" class="py-16 bg-slate-100">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-12">Instalacja Bookmarklet</h2>
            
            <div class="max-w-4xl mx-auto">
                <div class="bg-amber-50 border-l-4 border-amber-400 p-6 mb-8 rounded-r-lg">
                    <div class="flex items-start">
                        <i class="fas fa-info-circle text-amber-600 mt-1 mr-3"></i>
                        <div>
                            <h3 class="font-semibold text-amber-800 mb-2">Co to jest bookmarklet?</h3>
                            <p class="text-amber-700 text-sm">
                                Bookmarklet to zwykła zakładka w przeglądarce, która zamiast otwierania strony, wykonuje kod JavaScript. 
                                Po dodaniu do zakładek będziesz mógł generować oferty jednym kliknięciem z dowolnego Google Docs.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Krok 1 -->
                    <div class="step-card bg-white p-6 rounded-xl shadow-lg">
                        <div class="flex items-center mb-4">
                            <span class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold mr-3">1</span>
                            <h3 class="text-xl font-semibold">Dodaj Bookmarklet</h3>
                        </div>
                        <p class="text-slate-600 mb-4">Przeciągnij poniższy przycisk do paska zakładek w przeglądarce:</p>
                        
                        <div class="text-center bg-slate-50 p-4 rounded-lg">
                            <a href="javascript:(function()%7Bif(!window.location.hostname.includes('docs.google.com'))%7Balert('Ten%20bookmarklet%20dzia%C5%82a%20tylko%20w%20Google%20Docs!%5CnOtw%C3%B3rz%20sw%C3%B3j%20dokument%20z%20ofert%C4%85%20w%20Google%20Docs%20i%20kliknij%20ponownie.');return;%7Dif(!document.querySelector('.kix-appview-editor'))%7Balert('Nie%20mo%C5%BCna%20pobra%C4%87%20tre%C5%9Bci%20dokumentu.%5CnUpewnij%20si%C4%99,%20%C5%BCe%20dokument%20jest%20otwarty%20w%20trybie%20edycji.');return;%7Dif(document.getElementById('offerGeneratorModal'))%7Bdocument.getElementById('offerGeneratorModal').remove();%7Dconst%20modal=document.createElement('div');modal.id='offerGeneratorModal';modal.style.cssText='position:fixed;top:0;left:0;width:100%25;height:100%25;background:rgba(0,0,0,0.7);z-index:10000;display:flex;align-items:center;justify-content:center;font-family:Arial,sans-serif;';const%20container=document.createElement('div');container.style.cssText='background:white;padding:30px;border-radius:12px;box-shadow:0%2020px%2060px%20rgba(0,0,0,0.3);max-width:500px;width:90%25;max-height:90vh;overflow-y:auto;';const%20header=document.createElement('div');header.style.cssText='text-align:center;margin-bottom:25px;';const%20title=document.createElement('h2');title.style.cssText='color:%231a73e8;margin:0%200%2010px%200;font-size:24px;font-weight:500;';title.textContent='%F0%9F%8E%AF%20Generator%20Ofert';const%20subtitle=document.createElement('p');subtitle.style.cssText='color:%235f6368;margin:0;font-size:14px;';subtitle.textContent='Automatyczne%20generowanie%20interaktywnej%20oferty';header.appendChild(title);header.appendChild(subtitle);const%20configSection=document.createElement('div');configSection.id='configSection';const%20apiSection=document.createElement('div');apiSection.style.cssText='margin-bottom:20px;';const%20apiLabel=document.createElement('label');apiLabel.style.cssText='display:block;margin-bottom:8px;font-weight:500;color:%23202124;';apiLabel.textContent='Klucz%20API%20Gemini:';const%20apiInput=document.createElement('input');apiInput.type='password';apiInput.id='apiKeyInput';apiInput.placeholder='Wklej%20sw%C3%B3j%20klucz%20API...';apiInput.style.cssText='width:100%25;padding:12px;border:2px%20solid%20%23e8eaed;border-radius:8px;font-size:14px;box-sizing:border-box;';const%20apiLink=document.createElement('a');apiLink.href='https://aistudio.google.com/app/apikey';apiLink.target='_blank';apiLink.style.cssText='color:%231a73e8;font-size:12px;text-decoration:none;margin-top:5px;display:block;';apiLink.textContent='%F0%9F%94%97%20Pobierz%20klucz%20API%20(darmowy)';apiSection.appendChild(apiLabel);apiSection.appendChild(apiInput);apiSection.appendChild(apiLink);const%20modelSection=document.createElement('div');modelSection.style.cssText='margin-bottom:25px;';const%20modelLabel=document.createElement('label');modelLabel.style.cssText='display:block;margin-bottom:8px;font-weight:500;color:%23202124;';modelLabel.textContent='Model%20Gemini:';const%20modelSelect=document.createElement('select');modelSelect.id='modelSelect';modelSelect.style.cssText='width:100%25;padding:12px;border:2px%20solid%20%23e8eaed;border-radius:8px;font-size:14px;box-sizing:border-box;background:white;';const%20models=%5B%7Bvalue:'gemini-2.5-flash-preview-04-17',text:'Gemini%202.5%20Flash%20(zalecany)'%7D,%7Bvalue:'gemini-1.5-pro',text:'Gemini%201.5%20Pro'%7D,%7Bvalue:'gemini-1.5-flash',text:'Gemini%201.5%20Flash'%7D%5D;models.forEach(model=%3E%7Bconst%20option=document.createElement('option');option.value=model.value;option.textContent=model.text;modelSelect.appendChild(option);%7D);modelSection.appendChild(modelLabel);modelSection.appendChild(modelSelect);const%20buttonSection=document.createElement('div');buttonSection.style.cssText='display:flex;gap:10px;';const%20generateBtn=document.createElement('button');generateBtn.id='generateBtn';generateBtn.textContent='%F0%9F%9A%80%20Generuj%20Ofert%C4%99';generateBtn.style.cssText='flex:1;background:%231a73e8;color:white;border:none;padding:14px%2020px;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;';const%20cancelBtn=document.createElement('button');cancelBtn.id='cancelBtn';cancelBtn.textContent='Anuluj';cancelBtn.style.cssText='background:%23f8f9fa;color:%235f6368;border:2px%20solid%20%23e8eaed;padding:14px%2020px;border-radius:8px;font-size:16px;cursor:pointer;';buttonSection.appendChild(generateBtn);buttonSection.appendChild(cancelBtn);configSection.appendChild(apiSection);configSection.appendChild(modelSection);configSection.appendChild(buttonSection);container.appendChild(header);container.appendChild(configSection);modal.appendChild(container);const%20style=document.createElement('style');style.textContent='%23offerGeneratorModal%20button:hover%7Bopacity:0.9;%7D';document.head.appendChild(style);document.body.appendChild(modal);const%20savedApiKey=localStorage.getItem('gemini_api_key');const%20savedModel=localStorage.getItem('gemini_model')%7C%7C'gemini-2.5-flash-preview-04-17';if(savedApiKey)%7BapiInput.value=savedApiKey;%7DmodelSelect.value=savedModel;function%20closeModal()%7Bmodal.remove();style.remove();%7Dfunction%20getDocumentText()%7Btry%7Bconst%20textElements=document.querySelectorAll('.kix-lineview-text-block');if(textElements.length%3E0)%7Breturn%20Array.from(textElements).map(el=%3Eel.textContent%7C%7Cel.innerText).filter(text=%3Etext.trim()).join('%5Cn%5Cn');%7Dconst%20contentElements=document.querySelectorAll('.kix-paragraphrenderer');if(contentElements.length%3E0)%7Breturn%20Array.from(contentElements).map(el=%3Eel.textContent%7C%7Cel.innerText).filter(text=%3Etext.trim()).join('%5Cn%5Cn');%7Dconst%20editor=document.querySelector('.kix-appview-editor');if(editor)%7Breturn(editor.textContent%7C%7Ceditor.innerText%7C%7C'').trim();%7Dthrow%20new%20Error('Nie%20mo%C5%BCna%20znale%C5%BA%C4%87%20tre%C5%9Bci%20dokumentu');%7Dcatch(error)%7Bthrow%20new%20Error('Nie%20uda%C5%82o%20si%C4%99%20pobra%C4%87%20tre%C5%9Bci%20dokumentu.%20Upewnij%20si%C4%99,%20%C5%BCe%20dokument%20jest%20otwarty%20w%20trybie%20edycji.');%7D%7Dasync%20function%20generateOffer()%7Bconst%20apiKey=apiInput.value.trim();const%20model=modelSelect.value;if(!apiKey)%7Balert('Prosz%C4%99%20wprowadzi%C4%87%20klucz%20API%20Gemini');return;%7DlocalStorage.setItem('gemini_api_key',apiKey);localStorage.setItem('gemini_model',model);title.textContent='%E2%8F%B3%20Generowanie...';subtitle.textContent='Pobieranie%20tre%C5%9Bci%20dokumentu...';configSection.style.display='none';try%7Bawait%20new%20Promise(resolve=%3EsetTimeout(resolve,500));const%20documentText=getDocumentText();if(!documentText%7C%7CdocumentText.trim().length%3C50)%7Bthrow%20new%20Error('Dokument%20jest%20pusty%20lub%20zbyt%20kr%C3%B3tki.%20Dodaj%20wi%C4%99cej%20tre%C5%9Bci%20do%20oferty.');%7Dsubtitle.textContent='Wysy%C5%82anie%20do%20AI...';const%20baseUrl=window.location.origin;const%20response=await%20fetch(baseUrl+'%2Fapi%2Fgenerate',%7Bmethod:'POST',headers:%7B'Content-Type':'application%2Fjson','Accept':'application%2Fjson'%7D,body:JSON.stringify(%7BdocumentText:documentText,apiKey:apiKey,modelName:model%7D)%7D);if(!response.ok)%7Bconst%20errorText=await%20response.text();throw%20new%20Error(%60HTTP%20%24%7Bresponse.status%7D:%20%24%7BerrorText%7D%60);%7Dconst%20result=await%20response.json();if(!result.success)%7Bthrow%20new%20Error(result.error%7C%7C'B%C5%82%C4%85d%20API');%7Dif(result.offerData%26%26result.offerId)%7Bconst%20storageKey=%60offer_%24%7Bresult.offerId%7D%60;localStorage.setItem(storageKey,JSON.stringify(result.offerData));%7Dtitle.textContent='%E2%9C%85%20Gotowe!';subtitle.textContent='Link%20jest%20wa%C5%BCny%20przez%207%20dni';const%20linkContainer=document.createElement('div');linkContainer.style.cssText='background:%23f0f9ff;padding:15px;border-radius:8px;margin:20px%200;word-break:break-all;border:2px%20solid%20%233b82f6;';const%20linkLabel=document.createElement('div');linkLabel.style.cssText='font-size:14px;color:%235f6368;margin-bottom:8px;font-weight:500;';linkLabel.textContent='Link%20do%20Twojej%20oferty:';const%20offerLink=document.createElement('a');offerLink.href=result.url;offerLink.target='_blank';offerLink.style.cssText='color:%231a73e8;text-decoration:none;font-weight:bold;font-size:14px;display:block;margin-bottom:10px;';offerLink.textContent=result.url;const%20buttonContainer=document.createElement('div');buttonContainer.style.cssText='display:flex;gap:10px;margin-top:15px;';const%20copyBtn=document.createElement('button');copyBtn.style.cssText='flex:1;background:%231a73e8;color:white;border:none;padding:12px;border-radius:6px;font-size:14px;cursor:pointer;';copyBtn.textContent='%F0%9F%93%8B%20Kopiuj';const%20openBtn=document.createElement('button');openBtn.style.cssText='flex:1;background:%230d7377;color:white;border:none;padding:12px;border-radius:6px;font-size:14px;cursor:pointer;';openBtn.textContent='%F0%9F%9A%80%20Otw%C3%B3rz';const%20closeBtn=document.createElement('button');closeBtn.style.cssText='width:100%25;background:%23f8f9fa;color:%235f6368;border:2px%20solid%20%23e8eaed;padding:12px;border-radius:6px;font-size:14px;cursor:pointer;margin-top:10px;';closeBtn.textContent='Zamknij';copyBtn.addEventListener('click',async()=%3E%7Btry%7Bawait%20navigator.clipboard.writeText(result.url);copyBtn.textContent='%E2%9C%85%20Skopiowano!';setTimeout(()=%3E%7BcopyBtn.textContent='%F0%9F%93%8B%20Kopiuj';%7D,2000);%7Dcatch(e)%7Bconst%20textArea=document.createElement('textarea');textArea.value=result.url;document.body.appendChild(textArea);textArea.select();document.execCommand('copy');document.body.removeChild(textArea);copyBtn.textContent='%E2%9C%85%20Skopiowano!';setTimeout(()=%3E%7BcopyBtn.textContent='%F0%9F%93%8B%20Kopiuj';%7D,2000);%7D%7D);openBtn.addEventListener('click',()=%3E%7Bwindow.open(result.url,'_blank');%7D);closeBtn.addEventListener('click',closeModal);linkContainer.appendChild(linkLabel);linkContainer.appendChild(offerLink);buttonContainer.appendChild(copyBtn);buttonContainer.appendChild(openBtn);linkContainer.appendChild(buttonContainer);linkContainer.appendChild(closeBtn);container.appendChild(linkContainer);%7Dcatch(error)%7Btitle.textContent='%E2%9D%8C%20B%C5%82%C4%85d';subtitle.textContent=error.message%7C%7C'Wyst%C4%85pi%C5%82%20nieoczekiwany%20b%C5%82%C4%85d';const%20retryBtn=document.createElement('button');retryBtn.style.cssText='width:100%25;background:%231a73e8;color:white;border:none;padding:12px%2020px;border-radius:8px;font-size:14px;cursor:pointer;margin-top:15px;';retryBtn.textContent='%F0%9F%94%84%20Spr%C3%B3buj%20ponownie';retryBtn.addEventListener('click',()=%3E%7Btitle.textContent='%F0%9F%8E%AF%20Generator%20Ofert';subtitle.textContent='Automatyczne%20generowanie%20interaktywnej%20oferty';configSection.style.display='block';if(container.contains(retryBtn.parentElement))%7Bcontainer.removeChild(retryBtn.parentElement);%7D%7D);const%20errorContainer=document.createElement('div');errorContainer.appendChild(retryBtn);container.appendChild(errorContainer);%7D%7DgenerateBtn.addEventListener('click',generateOffer);cancelBtn.addEventListener('click',closeModal);modal.addEventListener('click',(e)=%3E%7Bif(e.target===modal)%7BcloseModal();%7D%7D);%7D)();" id="bookmarkletLink" class="bookmarklet-button" draggable="true">
                                <i class="fas fa-magic mr-2"></i>Generator Ofert
                            </a>
                            <p class="text-xs text-slate-500 mt-2">Przeciągnij ↑ do paska zakładek</p>
                        </div>

                        <div class="mt-4 text-sm text-slate-500">
                            <p><strong>Nie widzisz paska zakładek?</strong></p>
                            <p>Chrome/Edge: Ctrl+Shift+B</p>
                            <p>Firefox: Ctrl+Shift+B</p>
                        </div>
                    </div>

                    <!-- Krok 2 -->
                    <div class="step-card bg-white p-6 rounded-xl shadow-lg">
                        <div class="flex items-center mb-4">
                            <span class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold mr-3">2</span>
                            <h3 class="text-xl font-semibold">Skonfiguruj Klucz API</h3>
                        </div>
                        <p class="text-slate-600 mb-4">Potrzebujesz klucza API Gemini (darmowy):</p>
                        
                        <ol class="text-sm text-slate-600 space-y-2">
                            <li class="flex items-start">
                                <span class="w-5 h-5 bg-slate-200 rounded-full flex items-center justify-center text-xs font-bold mr-2 mt-0.5">1</span>
                                Idź do <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 hover:underline">Google AI Studio</a>
                            </li>
                            <li class="flex items-start">
                                <span class="w-5 h-5 bg-slate-200 rounded-full flex items-center justify-center text-xs font-bold mr-2 mt-0.5">2</span>
                                Kliknij "Create API Key"
                            </li>
                            <li class="flex items-start">
                                <span class="w-5 h-5 bg-slate-200 rounded-full flex items-center justify-center text-xs font-bold mr-2 mt-0.5">3</span>
                                Skopiuj klucz
                            </li>
                            <li class="flex items-start">
                                <span class="w-5 h-5 bg-slate-200 rounded-full flex items-center justify-center text-xs font-bold mr-2 mt-0.5">4</span>
                                Przy pierwszym użyciu bookmarklet poprosi o klucz
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Instructions -->
    <section id="instrukcja" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-12">Jak używać?</h2>
            
            <div class="max-w-4xl mx-auto">
                <div class="space-y-8">
                    <!-- Krok 1 -->
                    <div class="flex items-start space-x-6 p-6 bg-blue-50 rounded-xl">
                        <div class="w-12 h-12 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold text-xl">1</div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Przygotuj ofertę w Google Docs</h3>
                            <p class="text-slate-600 mb-2">Napisz ofertę w Google Docs jak zwykle. Generator automatycznie:</p>
                            <ul class="text-sm text-slate-600 space-y-1">
                                <li>• Rozpozna strukturę (nagłówki, listy, sekcje)</li>
                                <li>• Stworzy nawigację po sekcjach</li>
                                <li>• Przekształci w interaktywny HTML</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Krok 2 -->
                    <div class="flex items-start space-x-6 p-6 bg-green-50 rounded-xl">
                        <div class="w-12 h-12 bg-green-500 text-white rounded-full flex items-center justify-center font-bold text-xl">2</div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Kliknij bookmarklet w Google Docs</h3>
                            <p class="text-slate-600 mb-2">Gdy masz otwartą ofertę w Google Docs, kliknij na bookmarklet "Generator Ofert" w pasku zakładek.</p>
                        </div>
                    </div>

                    <!-- Krok 3 -->
                    <div class="flex items-start space-x-6 p-6 bg-purple-50 rounded-xl">
                        <div class="w-12 h-12 bg-purple-500 text-white rounded-full flex items-center justify-center font-bold text-xl">3</div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Otrzymaj publiczny link</h3>
                            <p class="text-slate-600 mb-2">Po kilku sekundach otrzymasz publiczny link do interaktywnej wersji oferty. Link jest ważny przez 7 dni.</p>
                        </div>
                    </div>

                    <!-- Krok 4 -->
                    <div class="flex items-start space-x-6 p-6 bg-amber-50 rounded-xl">
                        <div class="w-12 h-12 bg-amber-500 text-white rounded-full flex items-center justify-center font-bold text-xl">4</div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Udostępnij klientowi</h3>
                            <p class="text-slate-600">Wyślij link klientowi email, wstaw na swoją stronę, lub udostępnij w inny sposób. Nie potrzeba żadnych logowań!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section class="py-16 bg-slate-100">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-slate-800 mb-12">Często zadawane pytania</h2>
            
            <div class="max-w-3xl mx-auto space-y-4">
                <details class="bg-white p-6 rounded-lg shadow-md">
                    <summary class="font-semibold text-lg cursor-pointer text-slate-700 hover:text-blue-600">
                        Czy to jest bezpieczne? Gdzie przechowywane są moje oferty?
                    </summary>
                    <p class="mt-3 text-slate-600">
                        Oferty są tymczasowo przechowywane w Twojej przeglądarce (localStorage) i na naszych serwerach tylko przez 7 dni. 
                        Twój klucz API Gemini jest przechowywany tylko lokalnie w przeglądarce i nigdy nie jest wysyłany na nasze serwery.
                    </p>
                </details>

                <details class="bg-white p-6 rounded-lg shadow-md">
                    <summary class="font-semibold text-lg cursor-pointer text-slate-700 hover:text-blue-600">
                        Czy to jest darmowe?
                    </summary>
                    <p class="mt-3 text-slate-600">
                        Generator jest całkowicie darmowy. Jedynym kosztem może być użycie API Gemini, ale ma bardzo duży darmowy limit 
                        (1500 requestów dziennie), więc dla większości użytkowników będzie całkowicie za darmo.
                    </p>
                </details>

                <details class="bg-white p-6 rounded-lg shadow-md">
                    <summary class="font-semibold text-lg cursor-pointer text-slate-700 hover:text-blue-600">
                        Jak długo są ważne wygenerowane linki?
                    </summary>
                    <p class="mt-3 text-slate-600">
                        Wygenerowane linki są ważne przez 7 dni od momentu utworzenia. Po tym czasie automatycznie wygasają.
                    </p>
                </details>

                <details class="bg-white p-6 rounded-lg shadow-md">
                    <summary class="font-semibold text-lg cursor-pointer text-slate-700 hover:text-blue-600">
                        Czy mogę udostępnić bookmarklet zespołowi?
                    </summary>
                    <p class="mt-3 text-slate-600">
                        Tak! Wystarczy że wyślesz kolegom link do tej strony. Każdy będzie mógł dodać bookmarklet do swojej przeglądarki 
                        i używać ze swoim własnym kluczem API Gemini.
                    </p>
                </details>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-300 py-8">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; <span id="currentYear"></span> Generator Interaktywnych Ofert HTML. Projekt open-source.</p>
            <p class="text-sm mt-2">Wspierane przez Gemini AI i Tailwind CSS</p>
        </div>
    </footer>

    <script>
        // Ustaw aktualny rok
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Załaduj zapisane ustawienia
        const savedApiKey = localStorage.getItem('gemini_api_key');
        const savedModel = localStorage.getItem('gemini_model') || 'gemini-2.5-flash-preview-04-17';
        
        if (savedApiKey) {
            document.getElementById('apiKey').value = savedApiKey;
        }
        document.getElementById('modelSelect').value = savedModel;

        // Obsługa formularza
        const generateBtn = document.getElementById('generateBtn');
        const loadingState = document.getElementById('loadingState');
        const successState = document.getElementById('successState');
        const errorState = document.getElementById('errorState');
        const loadingText = document.getElementById('loadingText');
        const errorMessage = document.getElementById('errorMessage');
        const generatedLink = document.getElementById('generatedLink');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        const openLinkBtn = document.getElementById('openLinkBtn');
        const retryBtn = document.getElementById('retryBtn');
        const generateNewBtn = document.getElementById('generateNewBtn');

        function showState(state) {
            document.querySelector('.bg-white.p-8.rounded-xl.shadow-lg > div:nth-child(4)').style.display = state === 'form' ? 'block' : 'none';
            loadingState.classList.toggle('hidden', state !== 'loading');
            successState.classList.toggle('hidden', state !== 'success');
            errorState.classList.toggle('hidden', state !== 'error');
            generateBtn.style.display = state === 'form' ? 'block' : 'none';
        }

        async function generateOffer() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const model = document.getElementById('modelSelect').value;
            const offerText = document.getElementById('offerText').value.trim();

            if (!apiKey) {
                alert('Proszę wprowadzić klucz API Gemini');
                return;
            }

            if (!offerText || offerText.length < 50) {
                alert('Proszę wkleić treść oferty (minimum 50 znaków)');
                return;
            }

            // Zapisz ustawienia
            localStorage.setItem('gemini_api_key', apiKey);
            localStorage.setItem('gemini_model', model);

            showState('loading');
            loadingText.textContent = 'Wysyłanie do AI...';

            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        documentText: offerText,
                        apiKey: apiKey,
                        modelName: model
                    })
                });

                const responseText = await response.text();
                console.log('Response status:', response.status);
                console.log('Response text:', responseText);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${responseText}`);
                }

                let result;
                try {
                    result = JSON.parse(responseText);
                } catch (parseError) {
                    throw new Error(`Serwer zwrócił nieprawidłową odpowiedź: ${responseText.substring(0, 200)}`);
                }

                if (!result.success) {
                    throw new Error(result.error || 'Błąd API');
                }

                // Zapisz dane oferty w localStorage
                if (result.offerData && result.offerId) {
                    const storageKey = `offer_${result.offerId}`;
                    localStorage.setItem(storageKey, JSON.stringify(result.offerData));
                }

                // Pokaż sukces
                generatedLink.href = result.url;
                generatedLink.textContent = result.url;
                showState('success');

            } catch (error) {
                console.error('Błąd:', error);
                errorMessage.textContent = error.message || 'Wystąpił nieoczekiwany błąd';
                showState('error');
            }
        }

        // Event listeners
        generateBtn.addEventListener('click', generateOffer);
        retryBtn.addEventListener('click', () => showState('form'));
        generateNewBtn.addEventListener('click', () => showState('form'));

        copyLinkBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(generatedLink.href);
                copyLinkBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Skopiowano!';
                setTimeout(() => {
                    copyLinkBtn.innerHTML = '<i class="fas fa-copy mr-2"></i>Kopiuj Link';
                }, 2000);
            } catch (error) {
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = generatedLink.href;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                copyLinkBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Skopiowano!';
                setTimeout(() => {
                    copyLinkBtn.innerHTML = '<i class="fas fa-copy mr-2"></i>Kopiuj Link';
                }, 2000);
            }
        });

        openLinkBtn.addEventListener('click', () => {
            window.open(generatedLink.href, '_blank');
        });
    </script>
</body>
</html>
